import sampleSizeDemo from './sampleSizeDemo?raw'
import edgeCaseDemo from './edgeCaseDemo?raw'
import { CodeOrSourceMdx } from '@storybook/addon-docs/blocks'

# sampleSize

从集合中随机获取 n 个元素

## 详细介绍

`sampleSize` 从集合中随机获取 n 个不重复的元素，基于 **Fisher-Yates 洗牌算法**（部分洗牌）实现。

**核心原理**：

每次从未选中的区间 `[i, length-1]` 中随机选一个元素，交换到位置 `i` 后锁定。下一轮通过 `i + 随机数` 保证不会随机到前面已锁定的元素，只在后面未选中的部分随机。循环 `n` 次后，前 `n` 个位置就是随机选中的元素，最后用 `slice(0, n)` 裁剪返回。

以 `sampleSize([A, B, C, D, E], 3)` 为例：

```
初始: [A, B, C, D, E]

i=0: 从 [0,4] 随机到 3 → 交换 A 和 D → [D, B, C, A, E]  ← D 锁定
i=1: 从 [1,4] 随机到 4 → 交换 B 和 E → [D, E, C, A, B]  ← E 锁定
i=2: 从 [2,4] 随机到 2 → 交换 C 和 C → [D, E, C, A, B]  ← C 锁定

slice(0, 3) → [D, E, C]
```

**常用场景**：
- 随机抽奖、随机推荐
- 数据采样、A/B 测试分组
- 随机展示列表中的部分元素

## 基础用法

点击按钮查看 `sampleSize` 的基本使用效果。

<CodeOrSourceMdx language="typescript">
  {sampleSizeDemo}
</CodeOrSourceMdx>

## 边界情况验证

验证各种边界条件下的行为表现。

<CodeOrSourceMdx language="typescript">
  {edgeCaseDemo}
</CodeOrSourceMdx>

## 参数介绍

<table>
  <thead>
    <tr>
      <th>参数名</th>
      <th>类型</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>collection</td>
      <td><code>unknown</code></td>
      <td>要采样的集合</td>
    </tr>
    <tr>
      <td>n</td>
      <td><code>unknown</code></td>
      <td>要采样的元素个数，默认为 1</td>
    </tr>
  </tbody>
</table>

### 返回值

- 类型：`T[]`
- 描述：返回随机元素数组

## 具体实现原理

1. **文件职责**: `sampleSize/index.ts` 导出 sampleSize 函数
2. **核心流程**: 复制原数组 → 部分 Fisher-Yates 洗牌 n 次 → slice 裁剪前 n 个
3. **关键技术点**: `i + Math.floor(Math.random() * (length - i))` 保证随机范围仅在未锁定区间，交换后前面的位置即锁定，最后 slice 裁剪
4. **数据流向**: collection → 浅拷贝 → 循环 n 次随机交换锁定 → slice(0, n) → 返回结果
