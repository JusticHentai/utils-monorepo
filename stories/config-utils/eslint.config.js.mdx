import EslintConfig from '../../packages/config-utils/eslint.config.js?raw'
import { CodeOrSourceMdx } from '@storybook/addon-docs/blocks'

# eslint.config.js

- ESLint 配置文件

## 配置

<CodeOrSourceMdx language="javascript">
  {EslintConfig}
</CodeOrSourceMdx>

## 配置详解

### 导入的插件和工具

#### `import js from '@eslint/js'`
- 作用：ESLint 官方 JavaScript 规则集
- 说明：提供基础的 JavaScript 代码质量规则

#### `import eslintPluginPrettier from 'eslint-plugin-prettier/recommended'`
- 作用：集成 Prettier 作为 ESLint 规则
- 功能：
  - 将 Prettier 格式化问题作为 ESLint 错误报告
  - 禁用与 Prettier 冲突的 ESLint 格式化规则
  - 确保代码风格统一

#### `import reactHooks from 'eslint-plugin-react-hooks'`
- 作用：React Hooks 规则插件
- 功能：检查 Hooks 使用规范（如依赖数组、调用顺序等）

#### `import reactRefresh from 'eslint-plugin-react-refresh'`
- 作用：React Fast Refresh 支持插件
- 功能：确保组件导出符合 Fast Refresh 要求，避免热更新失效

#### `import globals from 'globals'`
- 作用：全局变量定义库
- 功能：提供浏览器、Node.js 等环境的全局变量定义，避免未定义变量报错

#### `import tsEslint from 'typescript-eslint'`
- 作用：TypeScript ESLint 集成
- 功能：提供 TypeScript 专用规则和配置工具

### 配置对象详解

#### `extends: [...]`
- 作用：继承预设配置
- 说明：
  - `js.configs.recommended`：JavaScript 推荐规则
  - `...tsEslint.configs.recommended`：TypeScript 推荐规则
  - `eslintPluginPrettier`：Prettier 集成配置

#### `files: ['**/*.{js,ts,tsx}']`
- 作用：指定该配置应用的文件
- 说明：匹配所有 `.js`、`.ts`、`.tsx` 文件

#### `ignores: ['**/dist/**']`
- 作用：忽略指定目录
- 说明：不检查 `dist` 目录下的文件

#### `languageOptions.ecmaVersion: 2020`
- 作用：指定 ECMAScript 版本
- 说明：启用 ES2020 语法支持（可选链、空值合并等）

#### `languageOptions.globals: globals.browser`
- 作用：定义浏览器全局变量
- 说明：识别 `window`、`document`、`console` 等，避免未定义报错
- 示例：
  ```javascript
  // 不会报错，因为 window 是浏览器全局变量
  window.location.href = 'https://example.com'
  ```

#### `plugins: { ... }`
- 作用：注册插件
- 说明：
  - `'react-hooks'`：React Hooks 规则
  - `'react-refresh'`：React Fast Refresh 规则

#### `rules: { ... }`
- 作用：自定义规则配置

##### `...reactHooks.configs.recommended.rules`
- 作用：应用 React Hooks 推荐规则
- 包含：
  - `react-hooks/rules-of-hooks`：Hooks 调用规则
  - `react-hooks/exhaustive-deps`：依赖数组完整性检查
- 示例：
  ```javascript
  // 违反规则：在条件语句中调用 Hook
  if (condition) {
    useState(0) // ❌ 错误：Hooks 必须在顶层调用
  }
  
  // 正确：在顶层调用
  const [count, setCount] = useState(0) // ✅
  ```

##### `'react-refresh/only-export-components': ['warn', { allowConstantExport: true }]`
- 作用：确保文件只导出 React 组件（用于 Fast Refresh）
- 级别：`warn`
- 选项：`allowConstantExport: true` 允许导出常量
- 示例：
  ```javascript
  // ✅ 允许：导出组件
  export default function MyComponent() {
    return <div>Hello</div>
  }
  
  // ✅ 允许：导出常量（因为 allowConstantExport: true）
  export const API_URL = 'https://api.example.com'
  
  // ⚠️ 警告：导出非组件函数
  export function helperFunction() {
    return 'helper'
  }
  ```

##### `'@typescript-eslint/no-explicit-any': 'off'`
- 作用：关闭禁止使用 `any` 类型的规则
- 说明：允许使用 `any`，但建议谨慎使用
- 示例：
  ```typescript
  // ✅ 不会报错（规则已关闭）
  function processData(data: any) {
    return data.value
  }
  ```
