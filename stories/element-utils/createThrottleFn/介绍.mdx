import basicDemo from './basicDemo?raw'
import { CodeOrSourceMdx } from '@storybook/addon-docs/blocks'

# createThrottleFn

创建节流函数的工具。

## 详细介绍

`createThrottleFn` 创建一个节流函数，确保在指定时间间隔内函数最多执行一次。与防抖不同，节流会在时间间隔内定期执行。

常用场景：
- 滚动事件处理
- 窗口 resize 事件
- 鼠标移动事件
- 游戏循环中的输入处理

## 基础节流

<CodeOrSourceMdx language="typescript">
  {basicDemo}
</CodeOrSourceMdx>

## 参数介绍

<table>
  <thead>
    <tr>
      <th>参数名</th>
      <th>类型</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>fn</td>
      <td><code>T extends (...args: any[]) =&gt; any</code></td>
      <td>要节流的函数</td>
    </tr>
    <tr>
      <td>wait</td>
      <td><code>number</code></td>
      <td>等待时间（毫秒），默认 1000</td>
    </tr>
    <tr>
      <td>options.leading</td>
      <td><code>boolean</code></td>
      <td>是否在延迟开始前调用，默认 true</td>
    </tr>
    <tr>
      <td>options.trailing</td>
      <td><code>boolean</code></td>
      <td>是否在延迟结束后调用，默认 true</td>
    </tr>
  </tbody>
</table>

## 返回值

<table>
  <thead>
    <tr>
      <th>属性</th>
      <th>类型</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>throttledFn</td>
      <td><code>ThrottledFn&lt;T&gt;</code></td>
      <td>节流后的函数</td>
    </tr>
    <tr>
      <td>throttledFn.cancel</td>
      <td><code>() =&gt; void</code></td>
      <td>取消待执行的节流函数</td>
    </tr>
    <tr>
      <td>throttledFn.flush</td>
      <td><code>() =&gt; ReturnType&lt;T&gt;</code></td>
      <td>立即执行节流函数</td>
    </tr>
  </tbody>
</table>

## 具体实现原理

1. **文件职责**: `index.ts` 包含节流函数的完整实现
2. **核心流程**: 
   - 首次调用时根据 leading 配置决定是否立即执行
   - 后续调用会被限制在 wait 时间间隔内
   - trailing 模式会在时间间隔结束时执行最后一次调用
3. **关键技术点**: 
   - 使用时间戳判断是否应该执行
   - 支持 leading 和 trailing 两种模式
   - 提供 cancel 和 flush 方法控制执行
