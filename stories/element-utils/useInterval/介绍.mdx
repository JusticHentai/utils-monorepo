import { CodeOrSourceMdx } from '@storybook/addon-docs/blocks'
import indexTsx from './index.tsx?raw'

# useInterval

管理 setInterval 的 Hook。

## 详细介绍

useInterval 封装了 setInterval，自动处理定时器的创建和清理，避免内存泄漏。支持动态调整间隔时间和首次立即执行。

### 使用场景

- 轮询数据
- 倒计时
- 定时刷新
- 动画循环

## 演示代码

<CodeOrSourceMdx language="tsx">
  {indexTsx}
</CodeOrSourceMdx>

## 参数介绍

<table>
  <thead>
    <tr>
      <th>参数名</th>
      <th>类型</th>
      <th>默认值</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>fn</td>
      <td><code>() =&gt; void</code></td>
      <td>-</td>
      <td>定时执行的函数</td>
    </tr>
    <tr>
      <td>delay</td>
      <td><code>number | undefined</code></td>
      <td>-</td>
      <td>间隔时间（毫秒），undefined 时停止定时器</td>
    </tr>
    <tr>
      <td>options.immediate</td>
      <td><code>boolean</code></td>
      <td><code>false</code></td>
      <td>是否在首次渲染时立即执行</td>
    </tr>
  </tbody>
</table>

## 返回值

<table>
  <thead>
    <tr>
      <th>类型</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>() =&gt; void</code></td>
      <td>清除定时器的函数</td>
    </tr>
  </tbody>
</table>

## 具体实现原理

### 核心流程

1. 使用 useRef 保存最新的回调函数
2. 使用 useRef 保存定时器 ID
3. 在 useEffect 中创建定时器
4. delay 变化或组件卸载时清除定时器
5. 返回手动清除定时器的函数
