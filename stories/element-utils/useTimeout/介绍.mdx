import { CodeOrSourceMdx } from '@storybook/addon-docs/blocks'
import indexTsx from './index.tsx?raw'

# useTimeout

管理 setTimeout 的 Hook。

## 详细介绍

useTimeout 封装了 setTimeout，自动处理定时器的创建和清理，避免内存泄漏。支持动态调整延迟时间。

### 使用场景

- 延迟执行操作
- 自动隐藏提示
- 延迟加载
- 动画延迟触发

## 演示代码

<CodeOrSourceMdx language="tsx">
  {indexTsx}
</CodeOrSourceMdx>

## 参数介绍

<table>
  <thead>
    <tr>
      <th>参数名</th>
      <th>类型</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>fn</td>
      <td><code>() =&gt; void</code></td>
      <td>延迟执行的函数</td>
    </tr>
    <tr>
      <td>delay</td>
      <td><code>number | undefined</code></td>
      <td>延迟时间（毫秒），undefined 时不执行</td>
    </tr>
  </tbody>
</table>

## 返回值

<table>
  <thead>
    <tr>
      <th>类型</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>() =&gt; void</code></td>
      <td>清除定时器的函数</td>
    </tr>
  </tbody>
</table>

## useTimeout vs useInterval

<table>
  <thead>
    <tr>
      <th>特性</th>
      <th>useTimeout</th>
      <th>useInterval</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>执行次数</td>
      <td>单次</td>
      <td>多次</td>
    </tr>
    <tr>
      <td>适用场景</td>
      <td>延迟操作</td>
      <td>轮询、动画</td>
    </tr>
    <tr>
      <td>定时器类型</td>
      <td>setTimeout</td>
      <td>setInterval</td>
    </tr>
  </tbody>
</table>

## 具体实现原理

### 核心流程

1. 使用 useRef 保存最新的回调函数
2. 使用 useRef 保存定时器 ID
3. 在 useEffect 中创建延时器
4. delay 变化或组件卸载时清除定时器
5. 返回手动清除定时器的函数
