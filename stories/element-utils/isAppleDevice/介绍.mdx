import basicDemo from './basicDemo?raw'
import { CodeOrSourceMdx } from '@storybook/addon-docs/blocks'

# isAppleDevice

检测当前设备是否为 Apple 设备（Mac、iPhone、iPod、iPad）。

## 详细介绍

在处理键盘事件时，Apple 设备与 Windows/Linux 设备的修饰键存在差异：Apple 设备使用 `Command (⌘)` 键（对应 `meta` 键），而其他平台使用 `Windows/Super` 键。不同平台的 `meta` 键对应不同的 `keyCode`：

- **Mac**: 左 Command = 91，右 Command = 93
- **Windows**: 左 Win = 91，右 Win = 92

此工具用于在需要区分平台行为的场景中判断设备类型，典型场景如键盘快捷键处理。

## 基础检测

检测当前设备是否为 Apple 设备，优先使用现代的 `navigator.userAgentData` API，降级使用 `navigator.platform`。

<CodeOrSourceMdx language="typescript">
  {basicDemo}
</CodeOrSourceMdx>

## 参数介绍

<table>
  <thead>
    <tr>
      <th>参数名</th>
      <th>类型</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>返回值</td>
      <td><code>boolean</code></td>
      <td>是否为 Apple 设备</td>
    </tr>
  </tbody>
</table>

## 典型使用场景

### 键盘快捷键适配

```typescript
import isAppleDevice from '@justichentai/element-utils/isAppleDevice'

// 根据平台选择不同的修饰键提示
const modifierKey = isAppleDevice() ? '⌘' : 'Ctrl'
console.log(`保存快捷键: ${modifierKey} + S`)
```

### Meta 键 keyCode 映射

```typescript
import isAppleDevice from '@justichentai/element-utils/isAppleDevice'

// Mac: Command 左 91 右 93 | Windows: Win 左 91 右 92
const metaKeyCodes = isAppleDevice() ? [91, 93] : [91, 92]
```

## 具体实现原理

### 文件结构

- `index.ts` - 唯一源文件，包含 isAppleDevice 函数实现

### 核心流程

1. 检查 `navigator` 是否存在（SSR 安全）
2. 优先使用 `navigator.userAgentData.platform`（现代 API）
3. 降级使用 `navigator.platform`（已废弃但兼容性好）
4. 通过正则匹配 Mac、iPhone、iPod、iPad 关键词

### 关键技术点

- **`navigator.userAgentData`**：Chrome 93+ 支持的现代 API，替代已废弃的 `navigator.platform`。返回的 `platform` 值为 `"macOS"`（Mac）或 `"iOS"`（移动端 Apple 设备）
- **`navigator.platform`**：作为降级方案，值为 `"MacIntel"`、`"iPhone"` 等，虽已废弃但所有浏览器仍支持
- **SSR 安全**：通过 `typeof navigator === 'undefined'` 守卫，避免在 Node.js 环境中报错
