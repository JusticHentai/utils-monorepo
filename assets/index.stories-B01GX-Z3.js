import{j as s}from"./jsx-runtime-u17CrQMm.js";/* empty css              */import{R as p}from"./index-CUfryva0.js";import"./index-HlNQgXsc.js";import"./index-GMzEpHqB.js";import"./index-DL3VI9dp.js";import"./index-CRyfxVlp.js";import"./index-Bwv5fkBO.js";import"./index-DADV4aVQ.js";import"./index-BtXwjIh0.js";import"./index-DbXIB-0m.js";const{action:a}=__STORYBOOK_MODULE_ACTIONS__,n=new p({onRequest:t=>{a("onRequest 回调")({url:t.url,method:t.method,status:t.status,duration:Math.round(t.duration||0)+"ms",success:t.success})},onError:t=>{a("onError 回调")({type:t.type,message:t.message,requestUrl:t.requestUrl})},ignoreUrls:[/hot-update/]}),d=(t,e)=>()=>{const o=t();o&&o();const u=n.observeAll();e(u),a("开启监控")("已开始监控 XHR + Fetch 请求")},{action:i}=__STORYBOOK_MODULE_ACTIONS__,_=(t,e)=>()=>{t()?(n.stop(),e(),i("停止监控")("已停止所有请求监控")):i("停止监控")("当前没有正在运行的监控")},{action:l}=__STORYBOOK_MODULE_ACTIONS__,O=()=>{const t=n.getStats(),e=n.getRequests();l("请求统计")({total:t.total,success:t.success,failed:t.failed,avgDuration:Math.round(t.avgDuration)+"ms",slowRequests:t.slowRequests,byStatus:t.byStatus}),l("请求记录")(e.map(o=>({url:o.url,method:o.method,status:o.status,duration:Math.round(o.duration||0)+"ms",success:o.success})))},{action:h}=__STORYBOOK_MODULE_ACTIONS__,R=()=>{const t=new XMLHttpRequest;t.open("GET","https://jsonplaceholder.typicode.com/posts/1"),t.send(),h("发送 XHR 请求")("GET https://jsonplaceholder.typicode.com/posts/1")},{action:D}=__STORYBOOK_MODULE_ACTIONS__,S=()=>{fetch("https://jsonplaceholder.typicode.com/users/1"),D("发送 Fetch 请求")("GET https://jsonplaceholder.typicode.com/users/1")},{action:T}=__STORYBOOK_MODULE_ACTIONS__,M=()=>{n.clear(),T("清空记录")("已清空所有请求记录")};let r=null;const j=d(()=>r,t=>{r=t}),v=_(()=>r,()=>{r=null}),m=()=>s.jsxs("div",{children:[s.jsx("div",{className:"button",onClick:j,children:"开启监控"}),s.jsx("div",{className:"button",onClick:v,children:"停止监控"}),s.jsx("div",{className:"button",onClick:R,children:"发送 XHR 请求"}),s.jsx("div",{className:"button",onClick:S,children:"发送 Fetch 请求"}),s.jsx("div",{className:"button",onClick:O,children:"查看统计信息"}),s.jsx("div",{className:"button",onClick:M,children:"清空记录"})]});m.__docgenInfo={description:"",methods:[],displayName:"RequestMonitorDemo"};const F={title:"element-utils/requestMonitor",component:m,parameters:{layout:"centered"},argTypes:{}},c={};c.parameters={...c.parameters,docs:{...c.parameters?.docs,source:{originalSource:"{}",...c.parameters?.docs?.source}}};const I=["Demo"];export{c as Demo,I as __namedExportsOrder,F as default};
