import{j as n}from"./jsx-runtime-u17CrQMm.js";/* empty css              */import{L as _}from"./index-Ch4uGxnA.js";import"./index-DIcNE1hc.js";import"./index-DbXIB-0m.js";import"./interface-l7xTqOLs.js";import"./performanceObserver-wogupI_g.js";import"./interface-Xy6dxNqB.js";const{action:m}=__STORYBOOK_MODULE_ACTIONS__,p=o=>()=>{const s=o();if(!s){m("TBT 计算")({message:'请先点击"开始监听长任务"按钮'});return}const t=s.calculateTBT();m("TBT 计算结果")({tbt:`${t.toFixed(2)}ms`,description:"TBT (Total Blocking Time) 是所有长任务超过 50ms 的部分总和",formula:"TBT = Σ(长任务持续时间 - 50ms)",goodThreshold:"< 200ms 为良好",needsImprovement:"200-600ms 需要改进",poor:"> 600ms 为较差"})},{action:c}=__STORYBOOK_MODULE_ACTIONS__,D=o=>()=>{const s=o();if(!s){c("统计信息")({message:'请先点击"开始监听长任务"按钮'});return}const t=s.getStats();t.count===0?c("统计信息")({message:"暂无记录的长任务",hint:'点击"触发长任务"按钮来生成一些长任务'}):c("统计信息")({count:t.count,totalDuration:`${t.totalDuration.toFixed(2)}ms`,maxDuration:`${t.maxDuration.toFixed(2)}ms`,avgDuration:`${t.avgDuration.toFixed(2)}ms`,entries:t.entries.map(e=>({name:e.name,duration:`${e.duration.toFixed(2)}ms`,startTime:`${e.startTime.toFixed(2)}ms`}))})},{action:u}=__STORYBOOK_MODULE_ACTIONS__,O=(o,s)=>()=>{const t=o();t&&t.stop();const e=new _;e.observe(a=>{u("检测到长任务")({name:a.name,duration:`${a.duration.toFixed(2)}ms`,startTime:`${a.startTime.toFixed(2)}ms`,attribution:a.attribution})},{threshold:50,reportExisting:!0}),s(e),u("开始监听")("长任务监听已启动，阈值: 50ms")},{action:l}=__STORYBOOK_MODULE_ACTIONS__,x=(o,s)=>()=>{const t=o();if(t){const e=t.getStats();t.stop(),t.clear(),s(),l("停止监听")({message:"长任务监听已停止",finalStats:{count:e.count,totalDuration:`${e.totalDuration.toFixed(2)}ms`,maxDuration:`${e.maxDuration.toFixed(2)}ms`,avgDuration:`${e.avgDuration.toFixed(2)}ms`}})}else l("停止监听")("当前没有活动的监听器")},{action:d}=__STORYBOOK_MODULE_ACTIONS__,g=()=>{d("触发长任务")("开始执行 100ms 的阻塞任务...");const o=performance.now();for(;performance.now()-o<100;);const t=performance.now()-o;d("长任务完成")({actualDuration:`${t.toFixed(2)}ms`,message:"如果监听已启动，应该会在 Actions 面板看到检测到的长任务"})};let r=null;const v=O(()=>r,o=>{r=o}),b=x(()=>r,()=>{r=null}),S=D(()=>r),$=p(()=>r),T=()=>n.jsxs("div",{children:[n.jsx("div",{className:"button",onClick:v,children:"开始监听长任务"}),n.jsx("div",{className:"button",onClick:b,children:"停止监听"}),n.jsx("div",{className:"button",onClick:g,children:"触发长任务"}),n.jsx("div",{className:"button",onClick:S,children:"获取统计信息"}),n.jsx("div",{className:"button",onClick:$,children:"计算 TBT"})]});T.__docgenInfo={description:"",methods:[],displayName:"LongTaskMonitorDemo"};const j={title:"element-utils/longTaskMonitor",component:T,parameters:{layout:"centered"},argTypes:{}},i={};i.parameters={...i.parameters,docs:{...i.parameters?.docs,source:{originalSource:"{}",...i.parameters?.docs?.source}}};const k=["Demo"];export{i as Demo,k as __namedExportsOrder,j as default};
