import{j as t}from"./jsx-runtime-u17CrQMm.js";import{r as n}from"./iframe-BWchUvSv.js";import{o as y,a as g,b,c as S,d as j,B as T}from"./index-BeKXAz7q.js";/* empty css              */import"./preload-helper-PPVm8Dsz.js";import"./index-BtXwjIh0.js";import"./index-DbXIB-0m.js";import"./index-DhV1O_Ae.js";import"./index-xKxNytmu.js";import"./index-Be32pr3j.js";import"./index-CSDXyHsi.js";import"./index-QD0SLaeG.js";const{action:p}=__STORYBOOK_MODULE_ACTIONS__,C=()=>{const o=y(e=>{p("点击行为")({type:e.type,target:e.target,data:e.data})},{capture:!0,sampleRate:1});p("点击监控已启动")("请点击页面任意元素，将捕获坐标和目标元素信息"),setTimeout(()=>{o(),p("点击监控已停止")("5 秒后自动停止")},5e3)},{action:m}=__STORYBOOK_MODULE_ACTIONS__,N=()=>{const o=g(e=>{m("输入行为")({type:e.type,target:e.target,data:e.data})},{recordValue:!0,sensitiveFields:["password","secret","token"],throttleMs:300});m("输入监控已启动")("请在输入框中输入内容，密码框和敏感字段的值不会被记录"),setTimeout(()=>{o(),m("输入监控已停止")("10 秒后自动停止")},1e4)},{action:u}=__STORYBOOK_MODULE_ACTIONS__,f=()=>{const o=b(e=>{u("路由变化")({type:e.type,data:e.data})});u("路由监控已启动")("将依次触发 pushState / replaceState / popstate"),history.pushState(null,"","#push-test"),setTimeout(()=>{history.replaceState(null,"","#replace-test")},500),setTimeout(()=>{history.back()},1e3),setTimeout(()=>{o(),u("路由监控已停止")("已恢复原始 History API")},2e3)},{action:_}=__STORYBOOK_MODULE_ACTIONS__,k=()=>{const o=S(e=>{_("滚动行为")({type:e.type,data:e.data})},{throttleMs:300,sampleRate:1});_("滚动监控已启动")("请滚动页面，将捕获滚动位置和视口信息（节流 300ms）"),setTimeout(()=>{o(),_("滚动监控已停止")("5 秒后自动停止")},5e3)},{action:x}=__STORYBOOK_MODULE_ACTIONS__,R=()=>{const o=j(e=>{x("可见性变化")({type:e.type,data:e.data})});x("可见性监控已启动")("请切换浏览器标签页，将捕获 visibilitychange 事件"),setTimeout(()=>{o(),x("可见性监控已停止")("30 秒后自动停止")},3e4)},{action:i}=__STORYBOOK_MODULE_ACTIONS__,h=()=>{const[o,e]=n.useState(!1),[l,d]=n.useState([]),a=n.useRef(null);n.useEffect(()=>{if(!o)return;const s=new T({maxBehaviors:50,inputOptions:{recordValue:!0}});return a.current=s,s.observe(r=>{d(s.getBehaviors()),i("行为捕获")(r)}),i("开始监听")("已启动行为监控"),()=>{s.stop(),a.current=null,i("停止监听")("已清理所有监听器")}},[o]);const O=()=>{const s=a.current;if(!s){i("提示")("请先开始监听");return}const r=s.trackCustom("用户操作",{action:"button_click",label:"自定义事件"});d(s.getBehaviors()),i("自定义行为")(r)},v=()=>{const s=a.current;s&&(s.clear(),d([]),i("清空记录")("已清空所有行为记录"))};return t.jsxs("div",{children:[t.jsx("div",{className:"button",onClick:()=>e(!0),children:"开始全量监听"}),t.jsx("div",{className:"button",onClick:()=>e(!1),children:"停止全量监听"}),t.jsx("div",{className:"button",onClick:O,children:"记录自定义行为"}),t.jsx("div",{className:"button",onClick:v,children:"清空行为记录"}),t.jsx("div",{className:"button",onClick:C,children:"单独监控点击（5s）"}),t.jsx("div",{className:"button",onClick:k,children:"单独监控滚动（5s）"}),t.jsx("div",{className:"button",onClick:N,children:"单独监控输入（10s）"}),t.jsx("div",{className:"button",onClick:f,children:"单独监控路由变化"}),t.jsx("div",{className:"button",onClick:R,children:"单独监控页面可见性（30s）"}),t.jsx("div",{className:"area",children:t.jsx("div",{id:"click-target",className:"card",children:"点击此区域测试"})}),t.jsxs("div",{className:"area",children:[t.jsx("input",{id:"text-input",type:"text",placeholder:"普通输入框",style:{padding:"8px 12px",borderRadius:6,border:"1px solid #ccc",marginRight:8}}),t.jsx("input",{id:"password-input",type:"password",placeholder:"密码输入框（敏感）",style:{padding:"8px 12px",borderRadius:6,border:"1px solid #ccc",marginRight:8}}),t.jsx("input",{id:"secret-input",name:"secret_key",type:"text",placeholder:"敏感字段输入框",style:{padding:"8px 12px",borderRadius:6,border:"1px solid #ccc"}})]}),t.jsxs("div",{className:"card",children:[t.jsxs("p",{children:["监听状态: ",o?"监听中":"未监听"]}),t.jsxs("p",{children:["已记录行为: ",l.length," 条"]}),l.length>0&&t.jsx("div",{style:{marginTop:8,textAlign:"left",fontSize:12},children:l.slice(-5).map((s,r)=>t.jsxs("p",{style:{margin:"4px 0",color:"#a8b4ff"},children:["[",s.type,"] ",new Date(s.timestamp).toLocaleTimeString(),s.data&&` - ${JSON.stringify(s.data).slice(0,60)}`]},r))})]})]})};h.__docgenInfo={description:"",methods:[],displayName:"BehaviorMonitorDemo"};const V={title:"element-utils/behaviorMonitor",component:h,parameters:{layout:"centered"},argTypes:{}},c={};c.parameters={...c.parameters,docs:{...c.parameters?.docs,source:{originalSource:"{}",...c.parameters?.docs?.source}}};const z=["Demo"];export{c as Demo,z as __namedExportsOrder,V as default};
