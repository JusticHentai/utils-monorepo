import{g as p,M as r}from"./index-B1yd03Fi.js";import{g as I}from"./index-BBae2uCj.js";import{E as A}from"./interface-l7xTqOLs.js";import{o as R}from"./index-B_uU3mD0.js";import{u as h}from"./index-CiAGgNxw.js";import{v as b}from"./index-BecUxZRD.js";import{c as _}from"./performanceObserver-wogupI_g.js";const y=10,L=(N,f)=>{const v=f?.reportAllChanges??!1,T=f?.durationThreshold??40;let i={name:r.INP,value:0,rating:p(r.INP,0),delta:0,id:h(),navigationType:I(),entries:[]};const l=new Map,t=[];let e=0,a=null;const M=()=>{const s=Math.min(t.length,y);if(s===0)return 0;t.sort((o,c)=>c.latency-o.latency);const n=Math.min(t.length-1,Math.floor(s/50));return t[n]?.latency||0},m=()=>{a&&(i={...i,value:e,delta:e-i.value,rating:p(r.INP,e),entries:[a]},N(i))},{stop:P}=_(A.EVENT,s=>{for(const n of s){if(!n.interactionId)continue;const o=n.duration,c=l.get(n.interactionId);if(c!==void 0&&o<=c)continue;l.set(n.interactionId,o);const g=t.findIndex(u=>u.id===n.interactionId);g>=0?t[g].latency=o:t.push({id:n.interactionId,latency:o}),t.length>y&&(t.sort((u,x)=>x.latency-u.latency),t.pop());const d=M();d<=0||d===e||(e=d,a=n,v&&m())}},{durationThreshold:T}),E=b({hidden:m,once:!0,safariCompat:!0}),C=R(()=>{l.clear(),t.length=0,e=0,a=null,i={name:r.INP,value:0,rating:p(r.INP,0),delta:0,id:h(),navigationType:I(),entries:[]}});return()=>{P(),E(),C()}};export{L as o};
