import{j as d}from"./jsx-runtime-u17CrQMm.js";/* empty css              */const g=(o,e,s)=>o.get(s)?.height??e,m=(o,e,s)=>{let t=0;for(let n=0;n<s;n++)t+=g(o,e,n);return t},b=(o,e,s,t)=>{let n=0,i=o.length-1;for(;n<=i;){const r=Math.floor((n+i)/2),l=m(e,s,r),a=g(e,s,r);if(l+a<t)n=r+1;else if(l>t)i=r-1;else return r}return Math.max(0,n)},p=(o,e,s)=>{let t=0;for(let n=0;n<o.length;n++)t+=g(e,s,n);return t},H=(o,e,s,t,n,i)=>{if(o.length===0)return{visibleItems:[],totalHeight:0,startIndex:0,endIndex:0};const r=Math.max(0,i);let l=b(o,e,t,r);l=Math.max(0,l-n);let a=l,_=m(e,t,l);for(;a<o.length&&_<r+s;)_+=g(e,t,a),a++;a=Math.min(o.length-1,a+n);const O=[];for(let c=l;c<=a;c++)O.push({data:o[c],index:c,offset:m(e,t,c),height:g(e,t,c)});return{visibleItems:O,totalHeight:p(o,e,t),startIndex:l,endIndex:a}},v=(o,e,s,t)=>{if(t<0||t>=o.length)throw new Error(`Invalid index: ${t}`);return m(e,s,t)},S=(o,e,s,t,n)=>{if(t<0||t>=o.length)throw new Error(`Invalid index: ${t}`);if(n<=0)throw new Error("height must be a positive number");const i=m(e,s,t);e.set(t,{index:t,height:n,offset:i})},u=o=>{const{items:e,containerHeight:s,estimatedItemHeight:t,overScan:n=3}=o;if(!Array.isArray(e))return{};if(s<=0)return{};if(t<=0)return{};const i=new Map;return{calculateVisibleItems:r=>H(e,i,s,t,n,r),updateItemHeight:(r,l)=>S(e,i,t,r,l),getTotalHeight:()=>p(e,i,t),getScrollTopForIndex:r=>v(e,i,t,r),reset:()=>{i.clear()}}},{action:h}=__STORYBOOK_MODULE_ACTIONS__,D=()=>{const o=Array.from({length:1e3},(t,n)=>({id:n,text:`Item ${n}`})),e=u({items:o,containerHeight:300,estimatedItemHeight:50}),s=e.calculateVisibleItems(0);h("总高度")(e.getTotalHeight()),h("scrollTop=0 时的可见项")(s),h("可见项数量")(s.visibleItems.length),h("startIndex")(s.startIndex),h("endIndex")(s.endIndex)},{action:I}=__STORYBOOK_MODULE_ACTIONS__,L=()=>{const o=Array.from({length:100},(n,i)=>({id:i,text:`Item ${i}`})),e=u({items:o,containerHeight:300,estimatedItemHeight:50});I("更新前 - 总高度")(e.getTotalHeight());const s=e.calculateVisibleItems(0);I("更新前 - 可见项范围")({startIndex:s.startIndex,endIndex:s.endIndex});for(let n=0;n<5;n++)e.updateItemHeight(n,100);I("更新后 - 总高度")(e.getTotalHeight());const t=e.calculateVisibleItems(0);I("更新后 - 可见项范围")({startIndex:t.startIndex,endIndex:t.endIndex}),I("高度差异")(e.getTotalHeight()-o.length*50)},{action:f}=__STORYBOOK_MODULE_ACTIONS__,C=()=>{const o=Array.from({length:100},(s,t)=>({id:t,text:`Item ${t}`})),e=u({items:o,containerHeight:300,estimatedItemHeight:50});for(let s=0;s<10;s++)e.updateItemHeight(s,80);f("更新后总高度")(e.getTotalHeight()),e.reset(),f("重置后总高度（恢复为预估值）")(e.getTotalHeight()),f("前后差值")(o.length*50-e.getTotalHeight())},{action:$}=__STORYBOOK_MODULE_ACTIONS__,A=()=>{const o=Array.from({length:500},(t,n)=>({id:n,text:`Item ${n}`})),e=u({items:o,containerHeight:300,estimatedItemHeight:40});[0,200,1e3,5e3,15e3].forEach(t=>{const n=e.calculateVisibleItems(t);$(`scrollTop=${t}`)({startIndex:n.startIndex,endIndex:n.endIndex,visibleCount:n.visibleItems.length,firstItem:n.visibleItems[0]?.data,lastItem:n.visibleItems[n.visibleItems.length-1]?.data})})},{action:E}=__STORYBOOK_MODULE_ACTIONS__,y=()=>{const o=Array.from({length:1e3},(t,n)=>({id:n,text:`Item ${n}`})),e=u({items:o,containerHeight:300,estimatedItemHeight:50});[0,10,50,100,500,999].forEach(t=>{const n=e.getScrollTopForIndex(t),i=e.calculateVisibleItems(n);E(`跳转到 Item ${t}`)({scrollTop:n,startIndex:i.startIndex,endIndex:i.endIndex})})},T=()=>d.jsxs("div",{children:[d.jsx("div",{className:"button",onClick:D,children:"基础用法"}),d.jsx("div",{className:"button",onClick:A,children:"滚动计算"}),d.jsx("div",{className:"button",onClick:L,children:"动态高度"}),d.jsx("div",{className:"button",onClick:y,children:"滚动到指定索引"}),d.jsx("div",{className:"button",onClick:C,children:"重置测量数据"})]});T.__docgenInfo={description:"",methods:[],displayName:"CreateVirtualListDemo"};const w={title:"element-utils/virtualList",component:T,parameters:{layout:"centered"},argTypes:{}},x={};x.parameters={...x.parameters,docs:{...x.parameters?.docs,source:{originalSource:"{}",...x.parameters?.docs?.source}}};const V=["Demo"];export{x as Demo,V as __namedExportsOrder,w as default};
