import{E as d}from"./interface-l7xTqOLs.js";import{c as m}from"./index-BINnBmJz.js";import{c as E}from"./index-BtXwjIh0.js";import{c as g}from"./performanceObserver-wogupI_g.js";const h=(e,t=500*1024)=>e.filter(o=>o.transferSize>t),f=e=>{const t=e.domainLookupEnd-e.domainLookupStart,o=e.connectEnd-e.connectStart,i=e.secureConnectionStart>0?e.connectEnd-e.secureConnectionStart:0,c=e.responseStart-e.requestStart,r=e.responseEnd-e.responseStart,s=e.transferSize===0||e.transferSize>0&&e.encodedBodySize===0;return{name:e.name,initiatorType:e.initiatorType,startTime:e.startTime,duration:e.duration,transferSize:e.transferSize,decodedBodySize:e.decodedBodySize,encodedBodySize:e.encodedBodySize,dns:t,tcp:o,tls:i,ttfb:c,download:r,fromCache:s,protocol:e.nextHopProtocol}},z=e=>{const t=performance.getEntriesByType(d.RESOURCE);return(e?t.filter(e):t).map(f)},R=e=>{const t={};let o=0,i=0,c=0;for(const r of e){r.fromCache&&o++,i+=r.transferSize,c+=r.duration;const s=r.initiatorType;t[s]||(t[s]={count:0,size:0,duration:0}),t[s].count++,t[s].size+=r.transferSize,t[s].duration+=r.duration}return{total:e.length,cached:o,totalSize:i,totalDuration:c,byType:t}},T=(e,t=1e3)=>e.filter(o=>o.duration>t),b=(e,t)=>{const{filter:o,batchSize:i=10,batchDelay:c=1e3}=t||{},{flush:r,add:s}=m(e,{batchSize:i,batchDelay:c}),u=n=>{const a=(o?n.filter(o):n).map(f);a.length!==0&&s(a)},{isActive:l,stop:S}=g(d.RESOURCE,u);if(!l)return()=>{};const p=E(window,"pagehide",r);return()=>{r(),S(),p()}};class w{filter;constructor(t){this.filter=t?.filter}getMetrics=()=>z(this.filter);getStats=()=>R(this.getMetrics());getSlowResources=t=>T(this.getMetrics(),t);getLargeResources=t=>h(this.getMetrics(),t);observe=(t,o)=>b(t,{filter:this.filter,...o})}export{w as R};
