import{j as a}from"./jsx-runtime-u17CrQMm.js";/* empty css              */import{r as i}from"./iframe-BWchUvSv.js";import{c as x}from"./mutationObserver-wiXghfWe.js";import"./preload-helper-PPVm8Dsz.js";import"./index-DHiFYDE3.js";import"./index-DbXIB-0m.js";import"./interface-Xy6dxNqB.js";const{action:s}=__STORYBOOK_MODULE_ACTIONS__,E=()=>{const e=window.__attributeChangeBasicEl||document.getElementById("attribute-change-demo");if(!e){s("请先初始化")();return}const t=`demo-class-${Date.now()}`;e.className=t,s("修改 class")(`设置为: ${t}`)},y=()=>{const e=window.__attributeChangeBasicEl||document.getElementById("attribute-change-demo");if(!e){s("请先初始化")();return}const t=`value-${Date.now()}`;e.dataset.value=t,s("修改 data-value")(`设置为: ${t}`)},D=()=>{const e=window.__attributeChangeBasicEl||document.getElementById("attribute-change-demo");if(!e){s("请先初始化")();return}e.style.background="linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",s("修改 style")("变更背景色")},O=()=>{s("清理完成")()},{action:o}=__STORYBOOK_MODULE_ACTIONS__,N=()=>{const e=window.__attributeChangeFilterEl||document.getElementById("attribute-filter-demo");if(!e){o("请先初始化")();return}const t=`filter-class-${Date.now()}`;e.className=t,o("修改 class（会触发）")(`设置为: ${t}`)},j=()=>{const e=window.__attributeChangeFilterEl||document.getElementById("attribute-filter-demo");if(!e){o("请先初始化")();return}e.dataset.value=`ignored-${Date.now()}`,o("修改 data-value（不会触发）")("因为只监听 class 属性")},I=()=>{o("清理完成")()},_=(e,t,r)=>{if(!e)return()=>{};const{stop:l}=x(e,c=>{c.forEach(n=>{if(n.type!=="attributes")return;const m=n.attributeName?n.target.getAttribute(n.attributeName):null;t(n.attributeName,n.oldValue,m,n.target)})},{attributes:!0,attributeOldValue:!0,childList:!1,subtree:!1,...r&&{attributeFilter:r}});return l},{action:d}=__STORYBOOK_MODULE_ACTIONS__,p=()=>{const e=i.useRef(null),t=i.useRef(null),[r,l]=i.useState(!1),[c,n]=i.useState(!1);i.useEffect(()=>{if(!r||!e.current)return;const h=_(e.current,(g,f,b)=>{d("属性变化")({属性名:g,旧值:f,新值:b})});return window.__attributeChangeBasicEl=e.current,d("初始化成功")("点击按钮修改属性触发回调"),()=>{h(),delete window.__attributeChangeBasicEl}},[r]),i.useEffect(()=>{if(!c||!t.current)return;const h=_(t.current,(g,f,b)=>{d("class 属性变化")({属性名:g,旧值:f,新值:b})},["class"]);return window.__attributeChangeFilterEl=t.current,d("初始化成功")("只监听 class 属性，其他属性变化不会触发回调"),()=>{h(),delete window.__attributeChangeFilterEl}},[c]);const m=()=>{l(!0)},C=()=>{l(!1),O()},w=()=>{n(!0)},v=()=>{n(!1),I()};return a.jsxs("div",{children:[a.jsx("div",{className:"button",onClick:m,children:"初始化基础示例"}),a.jsx("div",{className:"button",onClick:E,children:"修改 class"}),a.jsx("div",{className:"button",onClick:y,children:"修改 data-value"}),a.jsx("div",{className:"button",onClick:D,children:"修改 style"}),a.jsx("div",{className:"button",onClick:C,children:"清理基础示例"}),a.jsx("div",{className:"button",onClick:w,children:"初始化过滤示例 (只监听 class)"}),a.jsx("div",{className:"button",onClick:N,children:"修改 class (会触发)"}),a.jsx("div",{className:"button",onClick:j,children:"修改 data-value (不触发)"}),a.jsx("div",{className:"button",onClick:v,children:"清理过滤示例"}),a.jsxs("div",{style:{marginTop:40,display:"flex",gap:20,flexWrap:"wrap"},children:[r&&a.jsx("div",{ref:e,id:"attribute-change-demo","data-value":"initial",style:{width:200,height:100,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold"},children:"目标元素"}),c&&a.jsx("div",{ref:t,id:"attribute-filter-demo","data-value":"initial",style:{width:200,height:100,background:"linear-gradient(135deg, #11998e 0%, #38ef7d 100%)",borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold"},children:"只监听 class"})]})]})};p.__docgenInfo={description:"",methods:[],displayName:"OnAttributeChangeDemo"};const L={title:"element-utils/onAttributeChange",component:p,parameters:{layout:"centered"},argTypes:{}},u={};u.parameters={...u.parameters,docs:{...u.parameters?.docs,source:{originalSource:"{}",...u.parameters?.docs?.source}}};const M=["Demo"];export{u as Demo,M as __namedExportsOrder,L as default};
