import{f as l}from"./index-EnvM_XjC.js";import{i as m}from"./index-DOJC9J_n.js";import{i as f}from"./index-CPTfiPhJ.js";import{i as d}from"./index-DL3VI9dp.js";var p=(e=>(e.JS="JS",e.RESOURCE="RESOURCE",e.PROMISE="PROMISE",e.CONSOLE="CONSOLE",e))(p||{}),u=(e=>(e.SCRIPT="SCRIPT",e.LINK="LINK",e.IMG="IMG",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e))(u||{});const g=e=>{const o=console.error;return console.error=(...n)=>{const r=n.map(s=>typeof s=="object"?JSON.stringify(s):String(s)).join(" "),t={type:p.CONSOLE,message:r,timestamp:Date.now(),pageUrl:window.location.href,userAgent:navigator.userAgent};e(t),o.apply(console,n)},()=>{console.error=o}},w=e=>{const o=n=>{const{message:r,filename:t,lineno:s,colno:i,error:a}=n,c={type:p.JS,message:r,timestamp:Date.now(),pageUrl:window.location.href,userAgent:navigator.userAgent,filename:t,lineno:s,colno:i,stack:l(a?.stack)};e(c)};return window.addEventListener("error",o),()=>{window.removeEventListener("error",o)}},h=e=>{const o=n=>{const{reason:r}=n;let t="Unhandled Promise Rejection",s;m(r)?(t=r.message,s=l(r.stack)):d(r)?t=r:f(r)&&(t=JSON.stringify(r));const i={type:p.PROMISE,message:t,timestamp:Date.now(),pageUrl:window.location.href,userAgent:navigator.userAgent,stack:s,reason:r};e(i)};return window.addEventListener("unhandledrejection",o),()=>{window.removeEventListener("unhandledrejection",o)}},v=e=>{const o=n=>{const r=n.target,t=Object.values(u);if(!(r&&t.includes(r.tagName)))return;const i=r.src||r.href||"",a=`Failed to load ${r.tagName.toLowerCase()}: ${i}`,c={type:p.RESOURCE,message:a,timestamp:Date.now(),pageUrl:window.location.href,userAgent:navigator.userAgent,resourceUrl:i,resourceType:r.tagName.toLowerCase()};e(c)};return window.addEventListener("error",o,!0),()=>{window.removeEventListener("error",o,!0)}};class O{options;stoppers=[];constructor(o){this.options=o||{}}observe=o=>{const{jsError:n=!0,resourceError:r=!0,promiseError:t=!0,consoleError:s=!1,errorFilter:i}=this.options,a=c=>{i&&!i(c)||o(c)};return n&&this.stoppers.push(w(a)),r&&this.stoppers.push(v(a)),t&&this.stoppers.push(h(a)),s&&this.stoppers.push(g(a)),()=>this.stop()};stop=()=>{this.stoppers.forEach(o=>o()),this.stoppers=[]}}export{O as E,p as a};
