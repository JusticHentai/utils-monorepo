import{j as e}from"./jsx-runtime-u17CrQMm.js";import{r as o}from"./iframe-BWchUvSv.js";/* empty css              */import"./preload-helper-PPVm8Dsz.js";const u=(t,i)=>{const[s,n]=o.useState(!1),r=o.useRef(void 0),d=o.useCallback(()=>{r.current&&(r.current(),r.current=void 0),n(!1)},[]);return o.useEffect(()=>{if(!(s||!t))return n(!0),r.current=i(),()=>{r.current&&(r.current(),r.current=void 0)}},[t,i]),{executed:s,reset:d}},{action:a}=__STORYBOOK_MODULE_ACTIONS__,l=()=>{const[t,i]=o.useState(0),[s]=o.useState(3),{executed:n,reset:r}=u(t>=s,o.useCallback(()=>(a("条件满足，执行回调")(`count(${t}) >= threshold(${s})`),()=>{a("清理函数执行")("组件卸载或重置时调用")}),[t,s]));return e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:16,fontWeight:"bold"},children:"条件满足时只执行一次"}),e.jsxs("div",{style:{marginBottom:8},children:["当前计数：",e.jsx("span",{style:{fontWeight:"bold"},children:t})]}),e.jsxs("div",{style:{marginBottom:8},children:["触发阈值：",e.jsx("span",{style:{fontWeight:"bold"},children:s})]}),e.jsxs("div",{style:{marginBottom:16},children:["执行状态：",e.jsx("span",{style:{color:n?"#52c41a":"#ff4d4f",fontWeight:"bold"},children:n?"已执行":"未执行"})]}),e.jsx("div",{className:"button",onClick:()=>{i(d=>d+1),a("增加计数")(t+1)},children:"增加计数 (+1)"}),e.jsx("div",{className:"button",onClick:()=>{i(0),a("重置计数")(0)},children:"重置计数为 0"}),e.jsx("div",{className:"button",onClick:()=>{r(),a("调用 reset")("允许再次执行")},children:"调用 reset（允许再次执行）"}),e.jsx("div",{className:"area",children:e.jsxs("div",{style:{width:280,padding:20,background:n?"linear-gradient(135deg, #52c41a 0%, #73d13d 100%)":t>=s-1?"linear-gradient(135deg, #faad14 0%, #ffc53d 100%)":"linear-gradient(135deg, #1890ff 0%, #40a9ff 100%)",borderRadius:8,color:"white",textAlign:"center",transition:"all 0.3s"},children:[e.jsx("div",{style:{fontSize:14,marginBottom:8},children:n?"✅ 回调已执行":t>=s-1?"⚠️ 即将触发":"⏳ 等待条件满足"}),e.jsx("div",{style:{fontSize:12,opacity:.9},children:n?"调用 reset 后可再次触发":`还需增加 ${Math.max(0,s-t)} 次`})]})})]})};l.__docgenInfo={description:"",methods:[],displayName:"UseConditionalOnceDemo"};const p={title:"element-utils/useConditionalOnce",component:l,parameters:{layout:"centered"},argTypes:{}},c={};c.parameters={...c.parameters,docs:{...c.parameters?.docs,source:{originalSource:"{}",...c.parameters?.docs?.source}}};const g=["Demo"];export{c as Demo,g as __namedExportsOrder,p as default};
